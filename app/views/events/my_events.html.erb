<div class="container mt-5">
  <h2>My Events</h2>
  <hr>
  <h5>Events I'm Hosting</h5>
  <% if @hosted_events.any? %>
    <% @hosted_events.each do |event| %>
      <div class="card mb-3">
        <% if event.game.image_url.present? %>
          <div class="row g-0">
            <div class="col-md-4">
              <%= image_tag event.game.image_url, class: "img-fluid rounded-start", style: "max-width: 300px; height: auto;", alt: "#{event.game.title}" %>
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <h5 class="card-title"><%= event.title %></h5>
                <p class="card-text"><small class="text-muted">Date: <%= event.date_time.strftime("%B %d, %Y at %I:%M %p") %></small></p>
                <p class="card-text"><small class="text-muted">Location: <%= event.location %></small></p>
                <%= link_to 'View Event', event_path(event), class: "btn btn-primary" %>
                <%= link_to 'Edit Event', edit_event_path(event), class: "btn btn-warning" %>
                <%= link_to 'Delete Event', event_path(event), data: { turbo_method: :delete, turbo_confirm: 'Are you sure?' },class: 'btn btn-danger' %>
              </div>
            </div>
          </div>
        <% else %>
          <div class="card-body">
            <h5 class="card-title"><%= event.title %></h5>
          </div>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <p>You are not hosting any events.</p>
  <% end %>
  <hr>
  <h5>Events I've Reserved</h5>
  <% if @reserved_events.any? %>
    <% @reserved_events.each do |event| %>
      <% reservation = event.reservations.find_by(sender: current_user) %>
      <div class="card mb-3">
        <% if event.game.image_url.present? %>
          <div class="row g-0">
            <div class="col-md-4">
              <%= image_tag event.game.image_url, class: "img-fluid rounded-start", style: "max-width: 300px; height: auto;", alt: "#{event.game.title}" %>
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <h5 class="card-title"><%= event.title %></h5>
                <p class="card-text"><small class="text-muted">Date: <%= event.date_time.strftime("%B %d, %Y at %I:%M %p") %></small></p>
                <p class="card-text"><small class="text-muted">Location: <%= event.location %></small></p>
                <p class="card-text"><strong>Status:</strong> <%= reservation.status.titleize %></p>
                <%= link_to 'View Event', event_path(event), class: "btn btn-primary" %>
                <%= link_to 'Update Reservation', edit_reservation_path(reservation), class: "btn btn-secondary" %>
              </div>
            </div>
          </div>
        <% else %>
          <div class="card-body">
            <h5 class="card-title"><%= event.title %></h5>
            <p class="card-text"><%= event.description %></p>
            <p class="card-text"><small class="text-muted">Date: <%= event.date_time.strftime("%B %d, %Y at %I:%M %p") %></small></p>
            <p class="card-text"><small class="text-muted">Location: <%= event.location %></small></p>
            <%= link_to 'View Event', event_path(event), class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <p>You have no reserved events.</p>
  <% end %>
